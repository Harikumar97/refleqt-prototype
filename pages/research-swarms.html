<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refleqt Research Swarms - TaskFlow Dashboard</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f8f9fa;
            color: #2d3748;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: linear-gradient(180deg, #1a1f2e 0%, #2d3748 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            z-index: 1000;
        }

        .company-header {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .company-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .company-location {
            font-size: 14px;
            color: #a0aec0;
        }

        .obsession-widget {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }

        .obsession-score-large {
            font-size: 36px;
            font-weight: bold;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            color: #a0aec0;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .nav-link.active {
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
        }

        .nav-icon {
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 30px;
        }

        .swarms-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .swarms-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 100%;
            height: 200%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }

        .swarms-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        .swarms-subtitle {
            font-size: 16px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .swarms-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
        }

        /* Swarm Creator */
        .swarm-creator {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .creator-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
        }

        .creator-title {
            font-size: 20px;
            font-weight: bold;
            color: #2d3748;
        }

        .query-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            margin-bottom: 16px;
            transition: all 0.3s;
            resize: vertical;
            min-height: 120px;
        }

        .query-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .query-suggestions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .suggestion-chip {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            padding: 10px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .suggestion-chip:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .swarm-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .option-card {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-card.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }

        .option-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2d3748;
        }

        .option-description {
            font-size: 13px;
            color: #718096;
        }

        .launch-button {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .launch-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .launch-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Active Swarms */
        .active-swarms {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .swarms-grid {
            display: grid;
            gap: 20px;
        }

        .swarm-card {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .swarm-card.active {
            border-color: #48bb78;
            background: linear-gradient(135deg, #f0fff4 0%, #ffffff 100%);
        }

        .swarm-card.processing {
            border-color: #ed8936;
            background: linear-gradient(135deg, #fffaf0 0%, #ffffff 100%);
        }

        .swarm-card.completed {
            border-color: #4299e1;
            background: linear-gradient(135deg, #ebf8ff 0%, #ffffff 100%);
        }

        .swarm-header-card {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .swarm-title-card {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 4px;
        }

        .swarm-query {
            font-size: 14px;
            color: #718096;
            margin-bottom: 12px;
        }

        .swarm-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #c6f6d5;
            color: #2f855a;
        }

        .status-processing {
            background: #fbd38d;
            color: #c05621;
        }

        .status-completed {
            background: #bee3f8;
            color: #2b6cb0;
        }

        .agents-section {
            margin-bottom: 16px;
        }

        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            margin-top: 8px;
        }

        .agent-chip {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 12px;
            text-align: center;
            position: relative;
        }

        .agent-chip.working {
            border-color: #48bb78;
            background: #f0fff4;
            animation: pulse 2s infinite;
        }

        .progress-section {
            margin-bottom: 16px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: 12px;
            color: #718096;
            display: flex;
            justify-content: space-between;
        }

        .findings-preview {
            background: #f7fafc;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
        }

        .findings-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2d3748;
        }

        .findings-list {
            list-style: none;
            font-size: 13px;
            color: #4a5568;
        }

        .findings-list li {
            margin-bottom: 4px;
            padding-left: 12px;
            position: relative;
        }

        .findings-list li::before {
            content: '•';
            color: #48bb78;
            position: absolute;
            left: 0;
        }

        .swarm-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .action-btn-small {
            padding: 6px 12px;
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn-small:hover {
            background: #667eea;
            color: white;
        }

        /* Swarm Control Panel */
        .control-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .swarm-stats {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .stats-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #2d3748;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .stat-item {
            text-align: center;
            padding: 12px;
            background: #f7fafc;
            border-radius: 8px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #2d3748;
        }

        .stat-label {
            font-size: 12px;
            color: #718096;
            text-transform: uppercase;
        }

        .swarm-templates {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .template-item {
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .template-item:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.02);
        }

        .template-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .template-description {
            font-size: 12px;
            color: #718096;
        }

        .research-insights {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .insight-item {
            padding: 12px;
            border-left: 4px solid #48bb78;
            background: #f0fff4;
            border-radius: 0 8px 8px 0;
            margin-bottom: 12px;
        }

        .insight-text {
            font-size: 14px;
            color: #2d3748;
            line-height: 1.5;
        }

        .insight-source {
            font-size: 12px;
            color: #718096;
            margin-top: 4px;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 4000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: all 0.3s ease;
        }

        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        .detailed-results {
            display: grid;
            gap: 20px;
        }

        .result-section {
            background: #f7fafc;
            border-radius: 12px;
            padding: 20px;
        }

        .result-section h3 {
            color: #2d3748;
            margin-bottom: 12px;
        }

        .competitive-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .competitor-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
        }

        .competitor-name {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .competitor-metrics {
            font-size: 12px;
            color: #718096;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.05);
            }
        }

        @keyframes working {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .loading-dots {
            display: inline-block;
            animation: working 1.5s infinite;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .swarms-layout {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .swarm-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Main App Component
        function App() {
            const [activeSwarms, setActiveSwarms] = useState([]);
            const [selectedSwarmType, setSelectedSwarmType] = useState('competitive');
            const [query, setQuery] = useState('');
            const [showModal, setShowModal] = useState(false);
            const [modalContent, setModalContent] = useState(null);
            const [obsessionScore, setObsessionScore] = useState(8.2);

            const swarmTypes = [
                {
                    id: 'competitive',
                    title: 'Competitive Intelligence',
                    description: 'Track competitor moves, pricing, features, and market positioning'
                },
                {
                    id: 'user_research',
                    title: 'User Behavior Analysis',
                    description: 'Deep dive into user journeys, pain points, and conversion barriers'
                },
                {
                    id: 'market_opportunity',
                    title: 'Market Opportunity',
                    description: 'Identify untapped segments, emerging trends, and growth vectors'
                }
            ];

            const suggestionQueries = [
                "Why do users abandon signup at step 2?",
                "How does Asana price their enterprise plans?",
                "What features drive SaaS conversion rates?",
                "Which project management tools target SMBs?",
                "Why is our trial-to-paid conversion low?",
                "What onboarding patterns work for SaaS?"
            ];

            const launchSwarm = (swarmQuery) => {
                const swarmId = Date.now();
                const newSwarm = {
                    id: swarmId,
                    query: swarmQuery,
                    type: selectedSwarmType,
                    status: 'active',
                    progress: 0,
                    agents: generateAgents(selectedSwarmType),
                    findings: [],
                    startTime: new Date(),
                    estimatedCompletion: new Date(Date.now() + 15 * 60000) // 15 minutes
                };

                setActiveSwarms(prev => [newSwarm, ...prev]);
                setQuery('');
                setObsessionScore(prev => Math.min(10, prev + 0.3));

                // Simulate swarm progression
                simulateSwarmProgress(swarmId);
            };

            const generateAgents = (type) => {
                const agentPools = {
                    competitive: [
                        { name: 'Web Crawler', status: 'working' },
                        { name: 'Price Monitor', status: 'working' },
                        { name: 'Feature Tracker', status: 'pending' },
                        { name: 'Social Listener', status: 'pending' },
                        { name: 'Review Analyzer', status: 'pending' }
                    ],
                    user_research: [
                        { name: 'Session Recorder', status: 'working' },
                        { name: 'Heatmap Analyzer', status: 'working' },
                        { name: 'Survey Collector', status: 'pending' },
                        { name: 'Journey Mapper', status: 'pending' },
                        { name: 'Feedback Parser', status: 'pending' }
                    ],
                    market_opportunity: [
                        { name: 'Trend Spotter', status: 'working' },
                        { name: 'Gap Analyzer', status: 'working' },
                        { name: 'Demand Tracker', status: 'pending' },
                        { name: 'TAM Calculator', status: 'pending' },
                        { name: 'Growth Predictor', status: 'pending' }
                    ]
                };
                return agentPools[type] || agentPools.competitive;
            };

            const simulateSwarmProgress = (swarmId) => {
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 15 + 5;
                    
                    setActiveSwarms(prev => prev.map(swarm => {
                        if (swarm.id === swarmId) {
                            const updatedSwarm = { ...swarm, progress: Math.min(100, progress) };
                            
                            // Update agent statuses
                            const workingAgentIndex = Math.floor((progress / 100) * swarm.agents.length);
                            updatedSwarm.agents = swarm.agents.map((agent, index) => ({
                                ...agent,
                                status: index <= workingAgentIndex ? 'working' : 'pending'
                            }));

                            // Add findings as progress increases
                            if (progress > 25 && updatedSwarm.findings.length === 0) {
                                updatedSwarm.findings = generateFindings(swarm.type, 1);
                            } else if (progress > 60 && updatedSwarm.findings.length === 1) {
                                updatedSwarm.findings = generateFindings(swarm.type, 2);
                            } else if (progress > 90 && updatedSwarm.findings.length === 2) {
                                updatedSwarm.findings = generateFindings(swarm.type, 3);
                                updatedSwarm.status = 'completed';
                            }

                            return updatedSwarm;
                        }
                        return swarm;
                    }));

                    if (progress >= 100) {
                        clearInterval(interval);
                    }
                }, 2000);
            };

            const generateFindings = (type, stage) => {
                const findingsData = {
                    competitive: [
                        ["Asana's new AI features launched with 73% positive sentiment"],
                        ["Asana's new AI features launched with 73% positive sentiment", "Monday.com increased enterprise pricing by 12%"],
                        ["Asana's new AI features launched with 73% positive sentiment", "Monday.com increased enterprise pricing by 12%", "Notion adding project management features - 15K beta users"]
                    ],
                    user_research: [
                        ["67% of users spend 3+ minutes on plan selection page"],
                        ["67% of users spend 3+ minutes on plan selection page", "Mobile signup completion rate 23% lower than desktop"],
                        ["67% of users spend 3+ minutes on plan selection page", "Mobile signup completion rate 23% lower than desktop", "Users who complete onboarding tour have 340% higher retention"]
                    ],
                    market_opportunity: [
                        ["SMB project management market growing 23% YoY"],
                        ["SMB project management market growing 23% YoY", "Remote team tools segment underserved"],
                        ["SMB project management market growing 23% YoY", "Remote team tools segment underserved", "API-first PM tools 156% demand increase"]
                    ]
                };
                return findingsData[type]?.[stage - 1] || [];
            };

            const viewSwarmResults = (swarm) => {
                setModalContent({
                    title: `Swarm Results: ${swarm.query}`,
                    swarm: swarm
                });
                setShowModal(true);
            };

            return (
                <div>
                    <Sidebar obsessionScore={obsessionScore} />
                    
                    <div className="main-content">
                        <div className="swarms-header">
                            <h1 className="swarms-title">🔬 Research Swarms</h1>
                            <p className="swarms-subtitle">
                                AI-powered multi-agent research system for deep competitive intelligence and market analysis
                            </p>
                        </div>

                        <div className="swarms-layout">
                            <div>
                                <SwarmCreator
                                    query={query}
                                    setQuery={setQuery}
                                    selectedSwarmType={selectedSwarmType}
                                    setSelectedSwarmType={setSelectedSwarmType}
                                    swarmTypes={swarmTypes}
                                    suggestionQueries={suggestionQueries}
                                    launchSwarm={launchSwarm}
                                />

                                <ActiveSwarms
                                    activeSwarms={activeSwarms}
                                    viewSwarmResults={viewSwarmResults}
                                />
                            </div>

                            <SwarmControlPanel activeSwarms={activeSwarms} />
                        </div>
                    </div>

                    <SwarmResultsModal
                        show={showModal}
                        onClose={() => setShowModal(false)}
                        content={modalContent}
                    />
                </div>
            );
        }

        // Sidebar Component
        function Sidebar({ obsessionScore }) {
            const navItems = [
                { id: 'intelligence', icon: '🏠', name: 'Intelligence Feed', active: false },
                { id: 'swarms', icon: '🔬', name: 'Research Swarms', active: true },
                { id: 'cohorts', icon: '🎯', name: 'Strategy Cohorts', active: false },
                { id: 'psychographics', icon: '🧠', name: 'Psychographics', active: false },
                { id: 'brewery', icon: '🍺', name: 'The Brewery', active: false }
            ];

            return (
                <div className="sidebar">
                    <div className="company-header">
                        <div className="company-name">TaskFlow</div>
                        <div className="company-location">🚀 Project Management SaaS</div>
                    </div>

                    <div className="obsession-widget">
                        <div style={{fontSize: '12px', opacity: 0.9, marginBottom: '8px'}}>Business Obsession</div>
                        <div className="obsession-score-large">{obsessionScore.toFixed(1)}</div>
                        <div style={{fontSize: '14px', opacity: 0.9, marginTop: '4px'}}>Obsessed</div>
                    </div>

                    <ul className="nav-menu">
                        {navItems.map(item => (
                            <li key={item.id} className="nav-item">
                                <a href="#" className={`nav-link ${item.active ? 'active' : ''}`}>
                                    <span className="nav-icon">{item.icon}</span>
                                    <span>{item.name}</span>
                                </a>
                            </li>
                        ))}
                    </ul>
                </div>
            );
        }

        // Swarm Creator Component
        function SwarmCreator({ 
            query, 
            setQuery, 
            selectedSwarmType, 
            setSelectedSwarmType, 
            swarmTypes, 
            suggestionQueries, 
            launchSwarm 
        }) {
            return (
                <div className="swarm-creator">
                    <div className="creator-header">
                        <span style={{fontSize: '24px'}}>🚀</span>
                        <h2 className="creator-title">Launch New Research Swarm</h2>
                    </div>

                    <textarea
                        className="query-input"
                        placeholder="What would you like the swarm to research? Be specific about your business challenge..."
                        value={query}
                        onChange={(e) => setQuery(e.target.value)}
                    />

                    <div className="query-suggestions">
                        {suggestionQueries.map((suggestion, index) => (
                            <div
                                key={index}
                                className="suggestion-chip"
                                onClick={() => setQuery(suggestion)}
                            >
                                {suggestion}
                            </div>
                        ))}
                    </div>

                    <div className="swarm-options">
                        {swarmTypes.map(type => (
                            <div
                                key={type.id}
                                className={`option-card ${selectedSwarmType === type.id ? 'selected' : ''}`}
                                onClick={() => setSelectedSwarmType(type.id)}
                            >
                                <div className="option-title">{type.title}</div>
                                <div className="option-description">{type.description}</div>
                            </div>
                        ))}
                    </div>

                    <button
                        className="launch-button"
                        disabled={!query.trim()}
                        onClick={() => launchSwarm(query)}
                    >
                        🔬 Launch Research Swarm
                    </button>
                </div>
            );
        }

        // Active Swarms Component
        function ActiveSwarms({ activeSwarms, viewSwarmResults }) {
            if (activeSwarms.length === 0) {
                return (
                    <div className="active-swarms">
                        <h2 style={{fontSize: '20px', fontWeight: 'bold', marginBottom: '16px', color: '#2d3748'}}>
                            Active Research Swarms
                        </h2>
                        <div style={{textAlign: 'center', padding: '40px', color: '#718096'}}>
                            <div style={{fontSize: '48px', marginBottom: '16px'}}>🔬</div>
                            <p>No active swarms. Launch your first research swarm to get started!</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="active-swarms">
                    <h2 style={{fontSize: '20px', fontWeight: 'bold', marginBottom: '16px', color: '#2d3748'}}>
                        Active Research Swarms ({activeSwarms.length})
                    </h2>
                    
                    <div className="swarms-grid">
                        {activeSwarms.map(swarm => (
                            <SwarmCard
                                key={swarm.id}
                                swarm={swarm}
                                onViewResults={() => viewSwarmResults(swarm)}
                            />
                        ))}
                    </div>
                </div>
            );
        }

        // Swarm Card Component
        function SwarmCard({ swarm, onViewResults }) {
            const getStatusClass = (status) => {
                switch(status) {
                    case 'active': return 'status-active';
                    case 'processing': return 'status-processing';
                    case 'completed': return 'status-completed';
                    default: return 'status-active';
                }
            };

            const getCardClass = (status) => {
                switch(status) {
                    case 'active': return 'swarm-card active';
                    case 'processing': return 'swarm-card processing';
                    case 'completed': return 'swarm-card completed';
                    default: return 'swarm-card active';
                }
            };

            const formatTimeRemaining = () => {
                if (swarm.status === 'completed') return 'Completed';
                const remaining = Math.max(0, Math.round((100 - swarm.progress) / 100 * 15));
                return `~${remaining} min remaining`;
            };

            return (
                <div className={getCardClass(swarm.status)}>
                    <div className="swarm-header-card">
                        <div>
                            <div className="swarm-title-card">
                                Research Swarm #{swarm.id.toString().slice(-4)}
                            </div>
                            <div className="swarm-query">"{swarm.query}"</div>
                        </div>
                        <div className={`swarm-status ${getStatusClass(swarm.status)}`}>
                            {swarm.status}
                        </div>
                    </div>

                    <div className="agents-section">
                        <div style={{fontSize: '14px', fontWeight: '600', marginBottom: '8px', color: '#2d3748'}}>
                            AI Agents ({swarm.agents.filter(a => a.status === 'working').length}/{swarm.agents.length} active)
                        </div>
                        <div className="agents-grid">
                            {swarm.agents.map((agent, index) => (
                                <div
                                    key={index}
                                    className={`agent-chip ${agent.status === 'working' ? 'working' : ''}`}
                                >
                                    {agent.name}
                                    {agent.status === 'working' && (
                                        <span className="loading-dots">...</span>
                                    )}
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="progress-section">
                        <div className="progress-bar">
                            <div 
                                className="progress-fill"
                                style={{width: `${swarm.progress}%`}}
                            ></div>
                        </div>
                        <div className="progress-text">
                            <span>{Math.round(swarm.progress)}% Complete</span>
                            <span>{formatTimeRemaining()}</span>
                        </div>
                    </div>

                    {swarm.findings.length > 0 && (
                        <div className="findings-preview">
                            <div className="findings-title">
                                🔍 Key Findings ({swarm.findings.length})
                            </div>
                            <ul className="findings-list">
                                {swarm.findings.slice(0, 3).map((finding, index) => (
                                    <li key={index}>{finding}</li>
                                ))}
                            </ul>
                        </div>
                    )}

                    <div className="swarm-actions">
                        {swarm.status === 'completed' && (
                            <button className="action-btn-small" onClick={onViewResults}>
                                📊 View Full Results
                            </button>
                        )}
                        <button className="action-btn-small">
                            ⏸️ Pause
                        </button>
                        <button className="action-btn-small">
                            📋 Export Data
                        </button>
                    </div>
                </div>
            );
        }

        // Swarm Control Panel Component
        function SwarmControlPanel({ activeSwarms }) {
            const totalSwarms = activeSwarms.length;
            const activeCount = activeSwarms.filter(s => s.status === 'active').length;
            const completedCount = activeSwarms.filter(s => s.status === 'completed').length;
            const avgProgress = totalSwarms > 0 
                ? Math.round(activeSwarms.reduce((sum, s) => sum + s.progress, 0) / totalSwarms)
                : 0;

            const templates = [
                {
                    title: "SaaS Conversion Analysis",
                    description: "Deep dive into signup flow, pricing pages, and user onboarding"
                },
                {
                    title: "Competitive Feature Gap",
                    description: "Identify missing features compared to top 5 competitors"
                },
                {
                    title: "User Churn Investigation",
                    description: "Analyze why users cancel and what triggers churn"
                },
                {
                    title: "Market Positioning Research",
                    description: "Find optimal positioning vs competitors in your space"
                },
                {
                    title: "Pricing Strategy Analysis",
                    description: "Competitive pricing research with recommendations"
                }
            ];

            const recentInsights = [
                {
                    text: "Asana's AI features launched with 12K+ social mentions in 6 hours",
                    source: "Social Listener Agent"
                },
                {
                    text: "67% of SaaS trials abandon at the plan selection step",
                    source: "User Journey Analyzer"
                },
                {
                    text: "Enterprise PM market growing 23% YoY, SMB segment underserved",
                    source: "Market Research Agent"
                }
            ];

            return (
                <div className="control-panel">
                    {/* Swarm Statistics */}
                    <div className="swarm-stats">
                        <h3 className="stats-title">📊 Swarm Statistics</h3>
                        <div className="stats-grid">
                            <div className="stat-item">
                                <div className="stat-value">{totalSwarms}</div>
                                <div className="stat-label">Total Swarms</div>
                            </div>
                            <div className="stat-item">
                                <div className="stat-value">{activeCount}</div>
                                <div className="stat-label">Active Now</div>
                            </div>
                            <div className="stat-item">
                                <div className="stat-value">{completedCount}</div>
                                <div className="stat-label">Completed</div>
                            </div>
                            <div className="stat-item">
                                <div className="stat-value">{avgProgress}%</div>
                                <div className="stat-label">Avg Progress</div>
                            </div>
                        </div>
                    </div>

                    {/* Quick Templates */}
                    <div className="swarm-templates">
                        <h3 className="stats-title">🚀 Quick Launch Templates</h3>
                        {templates.map((template, index) => (
                            <div key={index} className="template-item">
                                <div className="template-title">{template.title}</div>
                                <div className="template-description">{template.description}</div>
                            </div>
                        ))}
                    </div>

                    {/* Recent Insights */}
                    <div className="research-insights">
                        <h3 className="stats-title">💡 Recent Insights</h3>
                        {recentInsights.map((insight, index) => (
                            <div key={index} className="insight-item">
                                <div className="insight-text">{insight.text}</div>
                                <div className="insight-source">— {insight.source}</div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // Swarm Results Modal Component
        function SwarmResultsModal({ show, onClose, content }) {
            if (!content) return null;

            const { swarm } = content;

            const competitiveData = [
                {
                    name: "Asana",
                    pricing: "$10.99/user/month",
                    features: "AI Project Insights, Timeline, Portfolios",
                    userRating: "4.3/5",
                    marketShare: "23%"
                },
                {
                    name: "Monday.com", 
                    pricing: "$8/user/month",
                    features: "Workdocs, Automations, Dashboard",
                    userRating: "4.6/5", 
                    marketShare: "18%"
                },
                {
                    name: "Trello",
                    pricing: "$5/user/month", 
                    features: "Power-Ups, Butler, Calendar",
                    userRating: "4.4/5",
                    marketShare: "31%"
                }
            ];

            const actionableRecommendations = [
                {
                    priority: "High",
                    action: "Implement progressive disclosure in signup flow",
                    impact: "Potential 15-20% conversion improvement",
                    timeline: "2-3 weeks",
                    effort: "Medium"
                },
                {
                    priority: "High", 
                    action: "Add AI-powered project health scoring",
                    impact: "Competitive differentiation vs Asana",
                    timeline: "6-8 weeks",
                    effort: "High"
                },
                {
                    priority: "Medium",
                    action: "Create SMB-focused onboarding track", 
                    impact: "Tap underserved market segment",
                    timeline: "4-6 weeks",
                    effort: "Medium"
                }
            ];

            return (
                <div className={`modal-overlay ${show ? 'show' : ''}`} onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                        <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px'}}>
                            <h2 style={{fontSize: '24px', fontWeight: 'bold', color: '#2d3748'}}>
                                🔬 {content.title}
                            </h2>
                            <button 
                                onClick={onClose}
                                style={{background: 'none', border: 'none', fontSize: '24px', cursor: 'pointer', color: '#a0aec0'}}
                            >
                                ×
                            </button>
                        </div>

                        <div className="detailed-results">
                            {/* Executive Summary */}
                            <div className="result-section">
                                <h3>📋 Executive Summary</h3>
                                <p style={{lineHeight: '1.6', color: '#4a5568'}}>
                                    Research swarm completed comprehensive analysis of {swarm.query.toLowerCase()}. 
                                    Key findings indicate significant opportunities for improvement in user onboarding 
                                    and competitive positioning. {swarm.agents.length} AI agents analyzed {Math.floor(Math.random() * 1000 + 500)} 
                                    data points across competitor websites, user behavior analytics, and market research.
                                </p>
                            </div>

                            {/* Key Findings */}
                            <div className="result-section">
                                <h3>🔍 Detailed Findings</h3>
                                <ul style={{listStyle: 'none', paddingLeft: '0'}}>
                                    {swarm.findings.map((finding, index) => (
                                        <li key={index} style={{
                                            marginBottom: '12px',
                                            padding: '12px',
                                            background: 'white',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            borderLeft: '4px solid #48bb78'
                                        }}>
                                            <strong>Finding {index + 1}:</strong> {finding}
                                        </li>
                                    ))}
                                </ul>
                            </div>

                            {/* Competitive Analysis */}
                            {swarm.type === 'competitive' && (
                                <div className="result-section">
                                    <h3>🏆 Competitive Landscape</h3>
                                    <div className="competitive-analysis">
                                        {competitiveData.map((competitor, index) => (
                                            <div key={index} className="competitor-card">
                                                <div className="competitor-name">{competitor.name}</div>
                                                <div className="competitor-metrics">
                                                    <div style={{marginBottom: '4px'}}>
                                                        <strong>Pricing:</strong> {competitor.pricing}
                                                    </div>
                                                    <div style={{marginBottom: '4px'}}>
                                                        <strong>Key Features:</strong> {competitor.features}
                                                    </div>
                                                    <div style={{marginBottom: '4px'}}>
                                                        <strong>Rating:</strong> {competitor.userRating}
                                                    </div>
                                                    <div>
                                                        <strong>Market Share:</strong> {competitor.marketShare}
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Actionable Recommendations */}
                            <div className="result-section">
                                <h3>🎯 Actionable Recommendations</h3>
                                <div style={{display: 'grid', gap: '12px'}}>
                                    {actionableRecommendations.map((rec, index) => (
                                        <div key={index} style={{
                                            background: 'white',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            padding: '16px',
                                            borderLeft: `4px solid ${rec.priority === 'High' ? '#f56565' : '#ed8936'}`
                                        }}>
                                            <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '8px'}}>
                                                <h4 style={{color: '#2d3748', margin: 0}}>{rec.action}</h4>
                                                <span style={{
                                                    background: rec.priority === 'High' ? '#fed7d7' : '#fbd38d',
                                                    color: rec.priority === 'High' ? '#c53030' : '#c05621',
                                                    padding: '2px 8px',
                                                    borderRadius: '12px',
                                                    fontSize: '12px',
                                                    fontWeight: '600'
                                                }}>
                                                    {rec.priority}
                                                </span>
                                            </div>
                                            <div style={{fontSize: '14px', color: '#718096', marginBottom: '8px'}}>
                                                <strong>Impact:</strong> {rec.impact}
                                            </div>
                                            <div style={{display: 'flex', gap: '16px', fontSize: '12px', color: '#a0aec0'}}>
                                                <span><strong>Timeline:</strong> {rec.timeline}</span>
                                                <span><strong>Effort:</strong> {rec.effort}</span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* Data Sources */}
                            <div className="result-section">
                                <h3>📊 Data Sources</h3>
                                <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '12px'}}>
                                    {swarm.agents.map((agent, index) => (
                                        <div key={index} style={{
                                            background: 'white',
                                            border: '1px solid #e2e8f0', 
                                            borderRadius: '8px',
                                            padding: '12px',
                                            textAlign: 'center'
                                        }}>
                                            <div style={{fontWeight: '600', marginBottom: '4px'}}>{agent.name}</div>
                                            <div style={{fontSize: '12px', color: '#718096'}}>
                                                {Math.floor(Math.random() * 500 + 100)} data points
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        <div style={{marginTop: '24px', display: 'flex', justifyContent: 'flex-end', gap: '12px'}}>
                            <button 
                                onClick={onClose}
                                style={{
                                    padding: '10px 20px',
                                    background: '#f7fafc',
                                    border: '1px solid #e2e8f0',
                                    borderRadius: '8px',
                                    cursor: 'pointer'
                                }}
                            >
                                Close
                            </button>
                            <button 
                                style={{
                                    padding: '10px 20px',
                                    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                    color: 'white',
                                    border: 'none',
                                    borderRadius: '8px',
                                    cursor: 'pointer'
                                }}
                            >
                                📋 Create Tasks from Recommendations
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
